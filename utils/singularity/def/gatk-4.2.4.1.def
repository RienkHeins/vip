Bootstrap: localimage
From: sif/build/openjdk-17.sif

%help
    Genome Analysis Toolkit - Variant Discovery in High-Throughput Sequencing Data.
    Usage: java -jar /opt/gatk/lib/gatk.jar

%post
    version=4.2.4.1

    # install
    apk update
    apk add libgomp
    apk add --virtual=.build-dependencies curl

    mkdir -p /opt/gatk/lib
    curl -Ls -o gatk.zip "https://github.com/broadinstitute/gatk/releases/download/${version}/gatk-${version}.zip"
    echo "2dc007f534cca1e29253864601e480ce24ce376b4b2bbd7a491571f9ecedc2e2  gatk.zip" | sha256sum -c
    unzip -p gatk.zip "gatk-${version}/gatk-package-${version}-local.jar" > /opt/gatk/lib/gatk.jar

    # cleanup
    apk del .build-dependencies
    rm -rf /var/cache/apk/* gatk.zip
